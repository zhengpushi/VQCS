## OLD version

1. v1 初次尝试，公理化实现。

   * 文件：
     * Unit.v 单位模块
     * Basic.v 飞控中的一个实际案例。

   * 特点：
     * 这个版本使用了 **UnitKind, Unit 两级构造**。
     * Unit表示任意带有单位的表达式。这里**并没有区分计算和单位**。
       * Unit中含有：数量、基本单位、Unit的四则运算、一个指数运算。
     * 这里使用了很多公理来说明Unit运算满足Ring和Field，想要使用其化简能力。
       * 实际使用中，ring或field没有那么强的化简能力。
     * **自动化程度比较低，几乎无法使用。**这一版本算是一种尝试。
2. v2，改进版本，无公理。

   * 文件：
     * Unit.v 单位模块
     * Unit_props.v 尝试要证明一些性质，刚开始。
     * Basic.v 飞控中的一个实际案例。
   * 特点：
     * 在 v1 的数据结构的基础上进行，**但运算不再依赖公理，而是使用自定义的求值函数来处理。**
     * 有一个 ueval 函数，该函数过于复杂，没有完成。是一个半成品。
     * **设计了新的机制：求 coef, 求 Kind -> Z，然后构造一个 Unit**
       * unit_calc_coef  : Unit -> R
       * unit_count_kind : Unit -> UnitKind -> Z
       * unit_unify : Unit -> R * Unit
         * 这里初步提出了 Quantity := (R * Unit) 的概念。
     * **证明容易了很多，但在遇到 Rpower时，可能需要写一些Ltac来处理**。
   * 总结。这一版是目前版本的雏形，基本思想已经有了。但问题如下：
     * unit1 + unit2 的处理太粗糙，当两个单位不匹配时，给了默认值，而不是option方式处理，可能有错。
     * 试图提出语义的概念，但由于设计的太粗糙，无法实现，很多运算的性质未加证明，可能在代数运算中性质不够。做算术运算倒是够了。
3. v3，改进版本，仅一个测试性的简化问题模型。

   * 文件
     * unit_eqQuestion.v 一个简化的问题，可以说明问题。
   * 特点：
     * 数据结构分成了3层：UnitKind, BasicUnit, Unit。
       * UnitKind还是7种。
       * BasicUnit是两种构造，要么是 UnitKind，要么是 inv UnitKind，用于表达式 s,m, /s, /m 等。这样总共有14种。
       * Unit是三种构造，要么是BasicUnit，要么是递归的乘法，要么是递归的inv操作。
     * 区分了单位和计算，该版本仅关心单位。
     * 使用几个函数来规范化一个单位，但换了另一个思路
       * 借助list BasicUnit，规范化一个单位。利用permutation来判断两个列表等价。
       * 设计了一些函数，可以将Unit转换成 list BasicUnit，然后就能比较Unit了。
       * 需要证明Norm Form的规范化规则，以及证明这些规则已经确定生效。
     * 目前效果比较好。
   * 总结：
     * 只处理单位，没有系数。可能 minute，hour 不便于表达。
     * 由于高次时，ka.(ka.ka) 与 (ka.ka).ka 这类表达式还需要判定相同，所以还有问题。一种想法是，下一步继续抽象，取出次数。这就有了下一个版本。 
4. v4，基于v3，改进版本，可用性较好。

   * 文件
     * Unit.v 单位
     * Unit_props.v 一些证明
     * Quantity.v 数量
     * Quantity_props.v 一些证明
     * Raux.v 实数的辅助功能。
     * unit_eqQuestion.v 一个简化的问题，可以说明问题。
     * Basic.v 用于飞控的实例
     * Basic_verify.v 飞控的更多实例
     * Atmosphere.v 大气模型的实例
   * 特点：
     * 数据结构分成了4层：UnitKind, ElementUnit, BasicUnit, Unit
       * ElementUnit携带了一个有理数系数，可以表达 60s 这样的单位。
       * 使用有理数系数有个好处，在Coq中可以直观的显示。缺点，无法处理无理数PI。
     * 设计了 Quantity  = R * Unit, 区分了数值和单位，
       * 简化了处理。
       * 还有一个遗留问题，min = 60 s 的转换，尚不支持。不过应该不是很难。
     * 使用了几个函数来规范化一个单位，详见代码。需要做的事情是：
       * 这些函数一定要有一个规范，然后证明函数满足了该规范。
       * 主要的函数是：ulinsert, ulclean, list2u, unorm
     * 目前效果比较好。
     * Basic_verify 尚未完全验证完。
   * 其他发现
     * Basic.v 的文件末尾，有些公理会让 Coq 花费很长时间，也许要考虑用 bool 类型来做。
     * 意外发现， AAC_tactics这个库，貌似与Unit的需求神似。
     * coq-equations / STLC.v 也有关系。
5. v5, 2022年04月13日，比较完善
   * 文件：
     * 库文件（对标准库的一些扩展）
       * TacticExt.v
       * BoolExt.v
       * RExt.v
     * 主要功能的文件
       * Unit.v 定义单位的语法
       * NUnit.v 定义单位的语义
       * SI.v 验证国际单位制系统
       * Uconv.v 简单的转换函数，以后可能会扩充
       * Qalgebra.v 量的代数系统。已经实现的运算：比较、布尔比较，相等判定，加减乘数、整数幂、三角函数。已完成的性质：比较的等价关系，加法和乘法的交换、结合。
   * 特点：
     * 区分了语法和语义。
     * 语法上，Unit比较简洁，只有两个数据结构：BaseUnit，Unit。
     * 语义上，利用8元组来表示一个单位，分别是系数和7个量纲指数。
     * 量（Quantity）定义为 option Unit 类型，以支持各种类型操作。
       * 注意，这个定义不好，因为有时需要明确的单位，后来改成 (R * Unit) | Invalid 这两种构造。
6. v6，2022年04月20日，对v5版本的全面应用和修正
   * 文件
     * 库文件（对标准库的一些扩展）
       * BoolExt.v
       * ZExt.v
       * RExt.v
     * 主要功能的文件
       * Unit.v 定义单位的语法
       * NUnit.v 定义单位的语义
       * SI.v 验证国际单位制系统
       * Uconv.v 简单的转换函数
       * Qalgebra.v 量的代数系统。已经实现的运算：比较、布尔比较，相等判定，加减乘数、整数幂、三角函数。已完成的性质：比较的等价关系，加法和乘法的交换、结合。
       * test_PropulsionSystem/Basic.v 推进系统的基本定义
       * test_PropulsionSystem/Basic_verify.v 推进系统的数学推导验证
   * 特点
     * 更新了编译系统，支持更简单的项目管理，支持漂亮的html文档输出
     * 各个模块更加完整，进行了大量的改动。
     * 对Qsqrt，Qsimb等函数设计了专门的策略。
     * 对所有函数输入输出进行单位检查，已经用于实际的测试项目，完成了一半的证明。
   * 问题
     * 已发现一些问题，准备设计新的版本，主要有：
     * 自动化程度还是较低，因为Quantity无法构成ring，加法运算不封闭，也没有幺元。暂无法解决。
     * 由于Quantity是基于Unit，而不是NUnit，导致其只能使用等价关系来一点点重写，无法在在match等结构中重写。是否可以考虑用NUit作为载体来设计Quantity的运算。
     * 另一个主要的问题是，Quantity混合了数值和单位，几乎不区分 1'min和60's。虽然能够手动转换到想要的结果，但仍然希望一个特定变量其单位是固定的。例如，在要求输入 2'min 的地方，原先输入 120's也是正确的，但现在想要限制只能有唯一的输入2。